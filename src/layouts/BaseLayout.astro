---
interface Props {
    title?: string;
    description?: string;
    ogImage?: string;
    canonical?: string;
    metadata?: {
        title?: string;
        description?: string;
        ogImage?: string;
        canonical?: string;
        ignoreTitleTemplate?: boolean;
    };
}

import Seo from "../components/seo/Seo.astro";
import Schema from "../components/seo/Schema.astro";
import Navbar from "../components/layout/Navbar.astro";
import Footer from "../components/layout/Footer.astro";
import WaveBackground from "../components/background/WaveBackground.astro";
import "../styles/global.css";
import SpeedInsights from "@vercel/speed-insights/astro";
import Analytics from "@vercel/analytics/astro";

import { siteConfig } from "../config/site";

const { title, description, ogImage, canonical, metadata } = Astro.props;

const finalTitle = metadata?.title || title;
const finalDescription = metadata?.description || description;
const finalOgImage = metadata?.ogImage || ogImage;
const finalCanonical = metadata?.canonical || canonical;
const finalIgnoreTitleTemplate = metadata?.ignoreTitleTemplate || false;
---

<!doctype html>
<html lang={siteConfig.lang} class="scroll-smooth">
    <head>
        <Seo
            title={finalTitle}
            description={finalDescription}
            ogImage={finalOgImage}
            canonical={finalCanonical}
            ignoreTitleTemplate={finalIgnoreTitleTemplate}
        />
        <Schema type="WebSite" data={{}} />
        <slot name="head" />
        <script is:inline>
            const getTheme = () => {
                if (
                    typeof localStorage !== "undefined" &&
                    localStorage.getItem("theme")
                ) {
                    return localStorage.getItem("theme");
                }
                if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                    return "dark";
                }
                return "light";
            };

            const theme = getTheme();
            if (theme === "light") {
                document.documentElement.setAttribute("data-theme", "light");
            } else {
                document.documentElement.setAttribute("data-theme", "dark");
            }
            window.localStorage.setItem("theme", theme);
        </script>
    </head>
    <body
        class="bg-background text-foreground antialiased selection:bg-blue-500/30 dark:selection:text-blue-200"
    >
        <WaveBackground />
        <a
            href="#main-content"
            class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 z-50 rounded-md bg-primary px-4 py-2 text-white shadow-lg ring-2 ring-white"
        >
            Skip to content
        </a>

        <div class="relative flex min-h-screen flex-col overflow-x-hidden">
            <Navbar />
            <main id="main-content" class="relative z-10 grow pt-[72px]">
                <slot />
            </main>
            <Footer />
        </div>
        <SpeedInsights />
        <Analytics />
    </body>
</html>
